<% provide :head_tags do %>
  <script>
    document.addEventListener("DOMContentLoaded", function(){
        initMap(<%=@appointment.location[0][:coordinates]%>, <%=@appointment.location[1][:coordinates]%>)
    });
    if (location.href.indexOf('re')==-1) {
        location.href=location.href+'?re';
    }
  </script>
<% end %>

<p id="notice"><%= notice %></p>

<p>
  <strong>Patient:</strong>
  <% @patient = Patient.find(@appointment.patient_id) %>
  <%= @patient.first_name %> <%= @patient.last_name %>
</p>

<p>
  <strong>Driver:</strong>
  <% if @appointment.status == 0 %>
    <span style="color:red">unassigned</span>
  <% else %>
    <% @driver = Driver.find(@appointment.driver_id) %>
    <%= @driver.first_name %> <%= @driver.last_name %>
  <% end %>
</p>

<p>
  <strong>Date & Time:</strong>
  <p><%= Time.parse(@appointment.datetime).strftime("%a %b %d, %Y") %></p>
  <p><%= Time.parse(@appointment.datetime).strftime("%I:%M %p") %></p>
</p>

<p>
  <strong>Patient Address:</strong> 
  <p><%= @appointment.location[0][:name] %></p>
  <p><%= @appointment.location[0][:address] %></p>
</p>
  
<p>
  <strong>Destination Address:</strong>
  <p><%= @appointment.location[1][:name] %></p>
  <p><%= @appointment.location[1][:address] %></p>
</p>

<p>
  <strong>Map & Directions:</strong>
</p>

<div class='parent'> 
  <div class='child float-left-child' id="map"></div>
  <div class='child float-left-child' id="right-panel"></div>
</div></br>

<% if session[:login_type] == "D" %>
  <%= link_to 'Back', drivers_home_path %>
<% elsif session[:login_type] == "P" %>
  <%= link_to 'Back', patients_home_path %>
<% else %>
  <%= link_to 'Back', admins_home_path %>
<% end %>


